import numpy as np
from numpy import pi,sqrt,exp,cos,sin,arctan,arctan2,arccos,abs,linalg,identity,dot,conj,round
import time
import matplotlib.pyplot as plt
import matplotlib.colors as colors


#Definimos los valores de la conductividad del grafeno estirado y el rango de frecuencias a T = 0

Real_est =  np.array([3.18320801e+01, 2.62915115e+00, 7.01323297e-01, 3.16035617e-01,
 1.78932865e-01, 1.15067587e-01, 8.02646240e-02, 5.92483536e-02,
 4.55946240e-02, 3.62287744e-02, 2.95207986e-02, 2.45633331e-02,
 1.53500143e-02, 1.06504849e-02, 7.95145828e-03, 6.26994179e-03,
 5.16156499e-03, 4.40880260e-03, 3.90151368e-03, 3.55524825e-03,
 3.34436628e-03, 3.27126631e-03, 3.31339681e-03, 3.37291970e-03,
 3.44264819e-03, 3.53517502e-03, 3.65489400e-03, 3.80646784e-03,
 3.99594924e-03, 4.24668041e-03, 4.58208388e-03, 5.03052311e-03,
 5.65329720e-03, 6.55998483e-03, 7.96998668e-03, 1.04664390e-02,
 1.59319862e-02, 3.55384157e-02, 1.89808477e-01, 2.33269649e-01,
 2.41194350e-01, 2.44402897e-01, 2.46146826e-01, 2.47306371e-01,
 2.47992077e-01, 2.48554752e-01, 2.50096907e-01, 2.50794637e-01,
 2.51247894e-01, 2.51609069e-01, 2.51911696e-01, 2.52213661e-01,
 2.52531850e-01, 2.52830592e-01, 2.53154761e-01, 2.53475850e-01,
 2.53813275e-01, 2.54155904e-01, 2.54505709e-01, 2.54880061e-01,
 2.55264631e-01, 2.55419615e-01, 2.56075850e-01, 2.56505234e-01,
 2.56942208e-01, 2.57402396e-01, 2.57880881e-01, 2.58376298e-01,
 2.58888533e-01, 2.59418649e-01, 2.59966225e-01, 2.61394928e-01,
 2.64194889e-01, 2.66667603e-01, 2.69432936e-01, 2.79742664e-01,
 2.92544343e-01, 3.05367800e-01, 3.18422606e-01, 3.31698404e-01,
 3.45244727e-01, 3.59108057e-01, 3.73389311e-01, 3.88201599e-01,
 4.03745611e-01, 4.20183974e-01, 4.37779592e-01, 4.56873945e-01,
 4.78497987e-01, 5.79529259e-01, 6.47239916e-01, 7.11420019e-01,
 7.35117973e-01, 7.59211158e-01, 7.83837997e-01, 8.10040142e-01,
 8.37231476e-01, 8.67648730e-01, 8.92536506e-01, 9.28509175e-01,
 9.66185017e-01, 1.01809672e+00, 1.06916507e+00, 1.12951568e+00,
 1.20276590e+00, 1.29753332e+00, 1.43651435e+00, 1.66964729e+00,
 2.65746375e+00, 1.67065841e+00, 1.39577621e+00, 1.23499090e+00,
 1.12250554e+00, 1.03520678e+00, 9.64227006e-01, 9.03857319e-01,
 8.53407627e-01, 8.11338169e-01, 7.71076097e-01, 7.38731837e-01,
 7.08847279e-01, 6.44804926e-01, 6.61770677e-01, 5.68117903e-01,
 5.60821233e-01, 4.67959463e-01, 4.36138056e-01, 3.88306409e-01,
 3.44980936e-01, 3.08638076e-01, 2.71355723e-01, 2.46177041e-01,
 2.23213298e-01, 2.05044040e-01, 1.78977279e-01, 1.65906760e-01,
 1.48822502e-01, 1.35674482e-01, 1.16810506e-01, 9.70426736e-02,
 9.04231407e-02, 8.51500480e-02, 8.02434105e-02, 6.85212968e-02,
 2.05452067e-02, 2.90854674e-04, 9.76877864e-05, 3.26651625e-05,
 2.41008779e-05, 1.87851524e-05, 1.51486589e-05, 1.25203381e-05,
 1.05461605e-05, 9.01936661e-06, 7.81084595e-06, 6.83589446e-06,
 6.03675009e-06, 5.37276601e-06, 4.81458030e-06, 4.34050571e-06,
 3.93421338e-06, 3.58320134e-06, 3.27775533e-06, 3.01022746e-06])



Imag_est =  np.array([ 0.00000000e+00,  8.75778381e+00,  4.66372101e+00,  3.14276288e+00,
  2.36219325e+00,  1.88827191e+00,  1.56987586e+00,  1.34100020e+00,
  1.16831222e+00,  1.03313554e+00,  9.24340035e-01,  8.34714231e-01,
  6.35147151e-01,  5.03634235e-01,  4.08967136e-01,  3.36325548e-01,
  2.77730346e-01,  2.28637869e-01,  1.85877514e-01,  1.47399402e-01,
  1.11696883e-01,  7.76823893e-02,  4.39039560e-02,  3.32148270e-02,
  2.21354834e-02,  1.09928222e-02, -6.61050871e-04, -9.02536009e-03,
 -2.48778501e-02, -3.75393337e-02, -5.03504642e-02, -6.70419086e-02,
 -8.40487081e-02, -1.03418452e-01, -1.26372205e-01, -1.55250401e-01,
 -1.95347672e-01, -2.64728947e-01, -3.09881965e-01, -2.22679008e-01,
 -1.84215131e-01, -1.59212750e-01, -1.41437015e-01, -1.28198775e-01,
 -1.17373753e-01, -1.08663854e-01, -8.03378788e-02, -6.65956913e-02,
 -5.58164087e-02, -5.07636841e-02, -4.77607879e-02, -4.83522862e-02,
 -4.56889419e-02, -4.47719568e-02, -4.49148714e-02, -4.52899188e-02,
 -4.58887730e-02, -4.71464730e-02, -4.82809161e-02, -4.80575216e-02,
 -5.03320313e-02, -5.14697660e-02, -5.41363198e-02, -5.51921003e-02,
 -5.72080411e-02, -5.89937834e-02, -6.08933815e-02, -5.96366400e-02,
 -6.46185997e-02, -6.67043278e-02, -6.77402662e-02, -7.68852401e-02,
 -8.57226924e-02, -8.78258452e-02, -1.08956400e-01, -1.26468115e-01,
 -1.37211844e-01, -1.46656228e-01, -1.55246160e-01, -1.63351616e-01,
 -1.71628848e-01, -1.79381275e-01, -1.87936144e-01, -1.97585397e-01,
 -2.08202387e-01, -2.21270473e-01, -2.37999397e-01, -2.61748296e-01,
 -3.07104580e-01, -3.40914497e-01, -3.31237652e-01, -3.22098067e-01,
 -3.27233950e-01, -3.15990441e-01, -3.12999767e-01, -3.10107294e-01,
 -3.07287157e-01, -3.04496437e-01, -3.01651978e-01, -2.99025586e-01,
 -2.96315490e-01, -2.93634867e-01, -2.90886595e-01, -2.88078141e-01,
 -2.85061987e-01, -2.81583823e-01, -2.76792979e-01, -2.66918221e-01,
 -6.76858635e-03,  8.42432377e-01,  8.38073714e-01,  8.28076121e-01,
  8.16456087e-01,  8.04533926e-01,  7.92870769e-01,  7.81283224e-01,
  7.69842415e-01,  7.58539698e-01,  7.47448722e-01,  7.36725982e-01,
  7.26672199e-01,  7.15949344e-01,  7.05768660e-01,  6.77008220e-01,
  7.08148597e-01,  7.01773419e-01,  6.89681480e-01,  6.73581387e-01,
  6.57019106e-01,  6.38368473e-01,  6.22299385e-01,  6.02642627e-01,
  5.93356069e-01,  5.67919423e-01,  6.09975489e-01,  5.11761254e-01,
  5.22447913e-01,  5.09273380e-01,  4.92873895e-01,  4.81823853e-01,
  4.68151914e-01,  4.51615421e-01,  4.43459429e-01,  4.32858748e-01,
  3.26750615e-01,  2.56380914e-01,  2.10027318e-01,  1.78280923e-01,
  1.56156101e-01,  1.39369131e-01,  1.26070128e-01,  1.15221466e-01,
  1.06160761e-01,  9.84794663e-02,  9.18359138e-02,  8.60530064e-02,
  8.09942621e-02,  7.66662533e-02,  7.26606706e-02,  6.91445864e-02,
  6.58846362e-02,  6.29231511e-02,  6.02194774e-02,  5.77444371e-02])



h_w_est =  np.array([0.00000000e+00, 1.00000000e-01, 2.00000000e-01, 3.00000000e-01,
 4.00000000e-01, 5.00000000e-01, 6.00000000e-01, 7.00000000e-01,
 8.00000000e-01, 9.00000000e-01, 1.00000000e+00, 1.10000000e+00,
 1.40909091e+00, 1.71818182e+00, 2.02727273e+00, 2.33636364e+00,
 2.64545455e+00, 2.95454545e+00, 3.26363636e+00, 3.57272727e+00,
 3.88181818e+00, 4.19090909e+00, 4.50000000e+00, 4.59565217e+00,
 4.69130435e+00, 4.78695652e+00, 4.88260870e+00, 4.97826087e+00,
 5.07391304e+00, 5.16956522e+00, 5.26521739e+00, 5.36086957e+00,
 5.45652174e+00, 5.55217391e+00, 5.64782609e+00, 5.74347826e+00,
 5.83913043e+00, 5.93478261e+00, 6.03043478e+00, 6.12608696e+00,
 6.22173913e+00, 6.31739130e+00, 6.41304348e+00, 6.50869565e+00,
 6.60434783e+00, 6.70000000e+00, 7.23200000e+00, 7.76400000e+00,
 8.29600000e+00, 8.82800000e+00, 9.36000000e+00, 9.89200000e+00,
 1.04240000e+01, 1.09560000e+01, 1.14880000e+01, 1.20200000e+01,
 1.25520000e+01, 1.30840000e+01, 1.36160000e+01, 1.41480000e+01,
 1.46800000e+01, 1.52120000e+01, 1.57440000e+01, 1.62760000e+01,
 1.68080000e+01, 1.73400000e+01, 1.78720000e+01, 1.84040000e+01,
 1.89360000e+01, 1.94680000e+01, 2.00000000e+01, 2.18095238e+01,
 2.36190476e+01, 2.54285714e+01, 2.72380952e+01, 2.90476190e+01,
 3.08571429e+01, 3.26666667e+01, 3.44761905e+01, 3.62857143e+01,
 3.80952381e+01, 3.99047619e+01, 4.17142857e+01, 4.35238095e+01,
 4.53333333e+01, 4.71428571e+01, 4.89523810e+01, 5.07619048e+01,
 5.25714286e+01, 5.43809524e+01, 5.61904762e+01, 5.80000000e+01,
 5.86451613e+01, 5.92903226e+01, 5.99354839e+01, 6.05806452e+01,
 6.12258065e+01, 6.18709677e+01, 6.25161290e+01, 6.31612903e+01,
 6.38064516e+01, 6.44516129e+01, 6.50967742e+01, 6.57419355e+01,
 6.63870968e+01, 6.70322581e+01, 6.76774194e+01, 6.83225806e+01,
 6.89677419e+01, 6.96129032e+01, 7.02580645e+01, 7.09032258e+01,
 7.15483871e+01, 7.21935484e+01, 7.28387097e+01, 7.34838710e+01,
 7.41290323e+01, 7.47741935e+01, 7.54193548e+01, 7.60645161e+01,
 7.67096774e+01, 7.73548387e+01, 7.80000000e+01, 8.00000000e+01,
 8.20000000e+01, 8.40000000e+01, 8.60000000e+01, 8.80000000e+01,
 9.00000000e+01, 9.20000000e+01, 9.40000000e+01, 9.60000000e+01,
 9.80000000e+01, 1.00000000e+02, 1.02000000e+02, 1.04000000e+02,
 1.06000000e+02, 1.08000000e+02, 1.10000000e+02, 1.12000000e+02,
 1.14000000e+02, 1.16000000e+02, 1.18000000e+02, 1.20000000e+02,
 1.44047619e+02, 1.68095238e+02, 1.92142857e+02, 2.16190476e+02,
 2.40238095e+02, 2.64285714e+02, 2.88333333e+02, 3.12380952e+02,
 3.36428571e+02, 3.60476190e+02, 3.84523810e+02, 4.08571429e+02,
 4.32619048e+02, 4.56666667e+02, 4.80714286e+02, 5.04761905e+02,
 5.28809524e+02, 5.52857143e+02, 5.76904762e+02, 6.00952381e+02])



#Definimos los valores de la conductividad y el rango de frecuencias a T = 0

Real =  np.array([3.18319586e+01, 2.70446484e+00, 7.07636203e-01, 3.17422156e-01,
 1.79378551e-01, 1.15229367e-01, 8.03215074e-02, 5.92515764e-02,
 4.55727667e-02, 3.61901551e-02, 2.94802581e-02, 2.45146382e-02,
 1.52894605e-02, 1.05825612e-02, 7.87758866e-03, 6.19420313e-03,
 5.08245181e-03, 4.31875045e-03, 3.82520291e-03, 3.48005235e-03,
 3.26159904e-03, 3.17942212e-03, 3.26954976e-03, 3.34110957e-03,
 3.43732790e-03, 3.17379564e-03, 3.34975191e-03, 3.57879672e-03,
 3.87457284e-03, 4.26457846e-03, 4.85382990e-03, 5.51134446e-03,
 6.79229829e-03, 8.74968726e-03, 1.29380807e-02, 2.44413331e-02,
 1.25945445e-01, 2.27453899e-01, 2.38953455e-01, 2.42878951e-01,
 2.44847388e-01, 2.46022752e-01, 2.46807155e-01, 2.47595813e-01,
 0.24778607,     0.24873905,     0.24989459,     0.25004823,
 2.50162031e-01, 2.51110833e-01, 2.51629687e-01, 2.52505312e-01,
 2.53564188e-01, 2.55154810e-01, 2.55902276e-01, 2.57337419e-01,
 2.59772387e-01, 2.60182843e-01, 2.64227671e-01, 2.66722683e-01,
 2.69401196e-01, 2.82690709e-01, 2.95819556e-01, 3.09821858e-01,
 3.23729492e-01, 3.34387519e-01, 3.52307065e-01, 3.54969157e-01,
 3.64976286e-01, 3.75482681e-01, 3.87972915e-01, 3.99717336e-01,
 4.13534619e-01, 4.24396778e-01, 4.59576208e-01, 4.52045604e-01,
 4.21600741e-01, 5.06349226e-01, 5.83738120e-01, 6.14951410e-01,
 6.80942982e-01, 7.32592435e-01, 7.76863498e-01, 8.40453673e-01,
 9.03305630e-01, 9.99878786e-01, 1.10121750e+00, 1.28602201e+00,
 1.29262020e+00, 1.36457069e+00, 1.40993856e+00, 1.46397490e+00,
 1.53918540e+00, 1.62146578e+00, 1.75132538e+00, 1.93168893e+00,
 2.34576773e+00, 2.25763549e+00, 1.87383038e+00, 1.69574326e+00,
 1.56415356e+00, 1.47948317e+00, 1.36929050e+00, 1.33828325e+00,
 1.28219954e+00, 1.22583306e+00, 1.19217268e+00, 1.14276371e+00,
 6.26570145e-01, 5.09357835e-01, 3.64651738e-01, 2.43114248e-01,
 1.57068555e-01, 1.17855868e-01, 9.28254012e-02, 6.28230152e-02,
 5.50623967e-02, 3.88556185e-02, 3.26586820e-02, 2.43904377e-02,
 1.94159847e-02, 1.45921543e-02, 1.07105770e-02, 1.49287406e-04,
 4.69810456e-03, 3.32422001e-03, 5.59857626e-04, 9.78393282e-05,
 8.48670352e-05, 5.56809838e-05, 4.72872609e-05, 1.70901600e-05,
 1.44825401e-05, 1.32703964e-05, 1.22661661e-05, 1.14003064e-05,
 1.06401453e-05, 9.96509105e-06])

Imag =  np.array([0,  8.82650458e+00,  4.67888949e+00,  3.14861447e+00,
  2.36541132e+00,  1.89056459e+00,  1.57181445e+00,  1.34276605e+00,
  1.17008481e+00,  1.03502085e+00,  9.26978985e-01,  8.37005330e-01,
  6.37851513e-01,  5.06890280e-01,  4.12774704e-01,  3.40691527e-01,
  2.82799137e-01,  2.34196302e-01,  1.91828651e-01,  1.53452617e-01,
  1.18639354e-01,  8.51282061e-02,  4.09628293e-02,  2.97841374e-02,
  1.83274988e-02,  6.97696201e-03, -4.61067983e-03, -1.88063561e-02,
 -3.33582400e-02, -4.75532909e-02, -6.39576598e-02, -8.24814171e-02,
 -1.04081710e-01, -1.30634367e-01, -1.66162200e-01, -2.22605133e-01,
 -3.20934882e-01, -2.29408113e-01, -1.79858356e-01, -1.52323683e-01,
 -1.31615728e-01, -1.16975640e-01, -1.05475180e-01, -8.83322228e-02,
 -0.07635615,     -0.04768058,     -0.03304208,     -0.02517265,
 -2.26061882e-02, -2.26527622e-02, -2.70953829e-02, -3.26555835e-02,
 -3.88265987e-02, -4.40235220e-02, -5.14384483e-02, -5.98748638e-02,
 -6.61993695e-02, -7.60165543e-02, -8.52583061e-02, -9.70535128e-02,
 -1.11532905e-01, -1.29335033e-01, -1.45284550e-01, -1.52660790e-01,
 -1.62064823e-01, -1.67678083e-01, -1.79512094e-01, -1.80550713e-01,
 -1.90494390e-01, -1.93380194e-01, -1.97619071e-01, -2.05912990e-01,
 -2.14959481e-01, -2.28297205e-01, -2.41817387e-01, -2.59120420e-01,
 -2.84956581e-01, -3.53411101e-01, -3.43285890e-01, -3.35665107e-01,
 -3.31986291e-01, -3.24127774e-01, -3.24677833e-01, -3.10919800e-01,
 -3.05323419e-01, -3.09737870e-01, -3.02871369e-01, -2.53858489e-01,
 -2.87717078e-01, -2.86776441e-01, -2.85599379e-01, -2.84378364e-01,
 -2.82860688e-01, -2.80144302e-01, -2.77927592e-01, -2.71545248e-01,
 -2.40628907e-01,  8.31034048e-01,  8.50120659e-01,  8.50906223e-01,
  8.48087956e-01,  8.43973647e-01,  8.41088543e-01,  8.37238837e-01,
  8.33138833e-01,  8.29049478e-01,  8.24904317e-01,  8.20588810e-01,
  7.30146768e-01,  7.05366054e-01,  6.78740767e-01,  6.21839828e-01,
  5.74696365e-01,  5.31060166e-01,  5.09428274e-01,  4.59428479e-01,
  4.16105069e-01,  3.96602761e-01,  3.69393325e-01,  3.49316030e-01,
  3.37639445e-01,  3.10416016e-01,  2.92917294e-01,  2.77253483e-01,
  2.61174632e-01,  2.49968704e-01,  2.38151701e-01,  2.26964039e-01,
  2.17301668e-01,  2.07939085e-01,  1.99618454e-01,  1.91962746e-01,
  1.85052783e-01,  1.78748511e-01,  1.72947910e-01,  1.67574815e-01,
  1.62573056e-01,  1.57898845e-01])

h_w =  np.array([0.00000000e+00, 1.00000000e-01, 2.00000000e-01, 3.00000000e-01,
 4.00000000e-01, 5.00000000e-01, 6.00000000e-01, 7.00000000e-01,
 8.00000000e-01, 9.00000000e-01, 1.00000000e+00, 1.10000000e+00,
 1.40909091e+00, 1.71818182e+00, 2.02727273e+00, 2.33636364e+00,
 2.64545455e+00, 2.95454545e+00, 3.26363636e+00, 3.57272727e+00,
 3.88181818e+00, 4.19090909e+00, 4.60000000e+00, 4.70000000e+00,
 4.80000000e+00, 4.90000000e+00, 5.00000000e+00, 5.10000000e+00,
 5.20000000e+00, 5.30000000e+00, 5.40000000e+00, 5.50000000e+00,
 5.60000000e+00, 5.70000000e+00, 5.80000000e+00, 5.90000000e+00,
 6.00000000e+00, 6.10000000e+00, 6.20000000e+00, 6.30000000e+00,
 6.40000000e+00, 6.50000000e+00, 6.60000000e+00, 6.80000000e+00,
 7.,             8.15,           9.3,            10.45,
 1.16600000e+01, 1.65200000e+01, 2.13800000e+01, 2.62400000e+01,
 3.11000000e+01, 3.59600000e+01, 4.08200000e+01, 4.56800000e+01,
 5.05400000e+01, 5.54000000e+01, 6.02600000e+01, 6.51200000e+01,
 6.99800000e+01, 7.48400000e+01, 7.97000000e+01, 8.45600000e+01,
 8.94200000e+01, 9.42800000e+01, 9.91400000e+01, 1.00000000e+02,
 1.03500000e+02, 1.07000000e+02, 1.10500000e+02, 1.14000000e+02,
 1.17500000e+02, 1.21000000e+02, 1.24500000e+02, 1.28000000e+02,
 1.31500000e+02, 1.35000000e+02, 1.38500000e+02, 1.42000000e+02,
 1.45500000e+02, 1.49000000e+02, 1.52500000e+02, 1.56000000e+02,
 1.59500000e+02, 1.63000000e+02, 1.66500000e+02, 1.70000000e+02,
 1.70550000e+02, 1.71100000e+02, 1.71650000e+02, 1.72200000e+02,
 1.72750000e+02, 1.73300000e+02, 1.73850000e+02, 1.74400000e+02,
 1.74950000e+02, 1.75500000e+02, 1.76050000e+02, 1.76600000e+02,
 1.77150000e+02, 1.77700000e+02, 1.78250000e+02, 1.78800000e+02,
 1.79350000e+02, 1.79900000e+02, 1.80450000e+02, 1.81000000e+02,
 1.94967742e+02, 2.08935484e+02, 2.22903226e+02, 2.36870968e+02,
 2.50838710e+02, 2.64806452e+02, 2.78774194e+02, 2.92741935e+02,
 3.06709677e+02, 3.20677419e+02, 3.34645161e+02, 3.48612903e+02,
 3.62580645e+02, 3.76548387e+02, 3.90516129e+02, 4.04483871e+02,
 4.18451613e+02, 4.32419355e+02, 4.46387097e+02, 4.60354839e+02,
 4.74322581e+02, 4.88290323e+02, 5.02258065e+02, 5.16225806e+02,
 5.30193548e+02, 5.44161290e+02, 5.58129032e+02, 5.72096774e+02,
 5.86064516e+02, 6.00032258e+02])



z = np.zeros([len(h_w_est)])

mu = 0.1

#Graficamos los resultados con T = 0

plt.plot(h_w*mu/3, Real*4,label='Real',color = 'pink', alpha=1, linestyle='dashed')
plt.plot(h_w*mu/3, Imag*4,label='Imaginario',color = 'limegreen', alpha=1, linestyle='dashed')
plt.plot(h_w_est*mu/3, Real_est*4,label='Real Estirado')
plt.plot(h_w_est*mu/3, Imag_est*4,label='Imaginario Estirado')
plt.plot(h_w_est*mu/3, z,label='Cero', color = 'k',linestyle='dotted')
plt.legend(loc="upper right")
plt.ylabel('sig/sig_0')
plt.xlabel('hw (eV)')
plt.show()